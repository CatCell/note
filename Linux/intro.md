## 计算机概论

### 中央处理器

#### 处理器架构

> **指令集架构**（**Instruction Set Architecture** ，缩写为 **ISA**），又称指令集或指令集体系，是计算机体系结构中与程序设计有关的部分，包含了基本数据类型，指令集，寄存器，寻址模式，存储体系，中断，异常处理以及外部 I/O。指令集架构包含一系列的 opcode 即操作码（机器语言），以及由特定处理器执行的基本命令。
>
> **微架构**:是将指定指令集在处理器中如何执行实现的方法，**同一指令集可以有不同的微架构**，因同一指令可以通过不同的电路单元或组合来实现。不同的微架构有着不同的用途和性能，总体来说一大堆的运算单元、逻辑单元、寄存器等在各种总线和控制线的连接下组成了 CPU 的微架构。因此**处理器架构是微架构和指令集架构的结合**，指令集是处理器的语言，而微架构是具体的实现。

ISA 和微架构不同，不同微架构的电脑可以共享一种指令集，但是在电路设计上大相径庭。

#### intel core 的历代架构

[Intel CPU 微架构的演进与发展](https://blog.csdn.net/gatieme/article/details/121461546)

> **Tick-Tock 战略**，指的是每年按照工艺年-架构年交替升级产品，持续在前代产品的基础上改进.
> 当在 **工艺年(tick)** 的时候重点是使用新的制程，小幅修改微架构。
> 当在 **架构年(tock)** 的时候，将会推出较大改进的微架构，往往此时 ISA 也会扩展更多指令集，并且优化上年推出的制程，进一步改善功耗和良率，在已经取得成功的产品上持续改进，使得 Intel 始终保持对竞争对手的优势
>
> 2016 年 3 月 22 日，Intel 在财务报告中宣布，**Tick Tock 将放缓至三年一循环**，增加优化环节，进一步减缓实际更新的速度。至此改为三步走的 **PAO(Processor-Architecture-optimization) 策略**，即“制程-架构-优化”。
> 制程：在架构不变的情况下，缩小晶体管体积，以减少功耗及成本
> 架构：在制程不变的情况下，更新处理器架构，以提高性能
> 优化：在制程及架构不变的情况下，对架构进行修复及优化，将 BUG 减到最低，并提升处理器时钟频率

但是 connon lake(第八代 cpu 的 10nm 开山之作)问题多，加上 amd 堆核战略卓有成效，计划被迫调整，到 10 代 core 的实际进程是这样
![实际产品情况](https://img-blog.csdnimg.cn/91b3879150874e0c838ba294ec2df50c.jpg?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAQ0hFTkcgSmlhbg==,size_19,color_FFFFFF,t_70,g_se,x_16#pic_center)

[WikiWand](https://www.wikiwand.com/en/Tick%E2%80%93tock_model#Roadmap) 可以详细查看每代 core 和 intel 公司的 ticktock 计划关系以及对应的微架构和家族。

### 磁盘

#### 磁盘物理组成

![Alt text](Pic/%E6%9C%BA%E6%A2%B0%E7%A1%AC%E7%9B%98.webp)

- 机械臂
- 读写头
- 盘片
  - 磁道 track：组成了柱面 Cylinder
  - 扇区 Sector：两种设计：512Bytes 4KBytes
- 主轴马达
  ![Alt text](Pic/%E7%9B%98%E7%89%87.jpg)

#### 分区格式 Partition format

> 而通常磁盘可能有多个盘片，所有盘片的同一个磁道我们称为柱面 （Cylinder）通常那是文件系统的最小单位，也就是分区的最小单位啦！为什么说“通常”呢？因为近来有 GPT 这个可达到 64bit 纪录功能的分区表， 现在我们甚至可以使用扇区（sector）号码来作为分区单位哩！

- 分区最小单位：因为一个分区对应一个文件系统，所以也是文件系统最小单位。
- 可以看出 GPT 支持更细的分区
- “64bit”记录功能的分区表

##### MBR

MBR 最多支持 4 个分区。

最高支持 2.2T 容量硬盘(不使用逻辑分区情况下)

为什么 MBR 分区格式最多支持 2TB？

> 这个和 32 位操作系统没有关系完全是 MBR 分区表规范的原因
> ![MBR分区表](https://img2020.cnblogs.com/blog/741682/202010/741682-20201008184307747-1604693136.gif)
> MBR 分区表仅有 64B，而且还分成四份，一个分区记录只用了 16B，它的结构和上图是一样的，限制在于最后使用了 4B 记录之前的扇区数和总扇区数，观察一个分区表至多只能支持$2^{32}$个扇区

$$
2^{32+9+3}=2^{2+3+40} \tag{每个扇区512B}
$$

所以最多支持 2TB

##### GPT(GUID Partition Table)

LBA（Logical Block Address, LBA）为了兼容 4K 和 512Byte

| LBA0(MBR 相容区块)                                    | LBA1(GPT 表头记录)                                          | LBA2-33(实际记录分区)             | 最后 43LBA 区块 |
| ----------------------------------------------------- | ----------------------------------------------------------- | --------------------------------- | --------------- |
| 446Bytes 开机启动程序，相容模式(带一个特殊标志分区表) | 分区表本身的位置大小，备份 GPT 分区所在位置，CRC 校验机制码 | 一个分区记录四笔，共计 128 笔分区 | 备份 GPT 分区   |

##### 开机启动流程

1.  BIOS 最先启动，寻找磁盘第一个分区里的开机管理程序 446Bytes
2.  1.  MBR：开机管理程序(Boot loader)是 OS 安装时提供，故认识磁盘，拉取核心文件
    2.  GPT：LBA 仅提供第一阶段 bootloader，需要 BIOS boot 分区存放开机管理程序(实现多重开机)
3.  交给操作系统
